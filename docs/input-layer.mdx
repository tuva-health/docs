---
id: input-layer
title: "2. Input Layer"
---

import ExpandableTable from '@site/src/components/ExpandableTable';
import claimsMappingGuide from '@site/src/data/claims-mapping-guide.json';
import { CoreModelDescription } from '@site/src/components/CoreModelDescription';

Here we document the Input Layer.  The Input Layer is like the API for the Tuva Project.  Once raw data sources (e.g. claims and medical records) are mapped to the Input Layer the rest of the Tuva Project runs automatically (i.e. core data model and all the data marts).  

The Input Layer is designed to accomodate both claims and clinical data sources.

**Click on any row in the data dictionaries below to expand the table and reveal additional context useful for mapping data to that column.**

## Claims Input

### eligibility

<CoreModelDescription
  modelName="input_layer__eligibility"
  yamlPath="models/input_layer/input_layer__eligibility.yml"
/>

**Primary Key:**
   * person_id
   * member_id
   * enrollment_start_date
   * enrollment_end_date
   * payer
   * plan
   * data_source

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.eligibility.columns"
  tableData={claimsMappingGuide.eligibility}
/>

### medical_claim

The medical_claim table contains information on healthcare services and supplies provided to patients, billed by providers, and paid for by health insurers. It includes information on the provider who rendered the service, the amount paid for the service by the health insurer, and the underlying reason for the service (i.e. diagnosis).  Each record in the table is intended to represent a unique claim line.

**Primary Key:**
  * claim_id
  * claim_line_number
  * data_source

**Foreign Keys:**
  * person_id
  * member_id

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.medical_claim.columns"
  tableData={claimsMappingGuide.medical_claim}
/>

### pharmacy_claim

The pharmacy_claim table includes information about retail and specialty drug prescriptions that have been filled by a patient, billed by a pharmacy, and paid by an insurer.  Each record in the table is intended to represent a unique claim line.

**Primary Key:**
  * claim_id
  * claim_line_number
  * data_source

**Foreign Keys:**
  * person_id
  * member_id

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.pharmacy_claim.columns"
  tableData={claimsMappingGuide.pharmacy_claim}
/>

### provider_attribution

:::note
To use the provider_attribution table, you must set the dbt variable `provider_attribution_enabled` to `true`.
:::

The provider_attribution table assigns a provider to each patient-member_month of eligibility. The user may assign both a payer-attributed provider (as typically assigned by the payer in VBC contracts) as well as custom-attributed provider (typically determined by the user). Fields related to each attributed provider (practice, organization, line of business) are also present.  Each record in the table is intended to represent a unique provider attribution for a patient in a specific month with a specific health plan.

**Primary Key:**
  * person_id
  * payer
  * plan
  * year_month
  * data_source

**Foreign Keys:**
  * person_id
  * patient_id

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.provider_attribution.columns"
  tableData={claimsMappingGuide.provider_attribution}
/>

## Clinical Input

### appointment

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.appointment.columns"
/>

### condition

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.condition.columns"
/>

### encounter

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.encounter.columns"
/>

### lab_result

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.lab_result.columns"
/>

### immunization

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.immunization.columns"
/>

### location

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.location.columns"
/>

### medication

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.medication.columns"
/>

### observation

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.observation.columns"
/>

### patient

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.patient.columns"
/>

### practitioner

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.practitioner.columns"
/>

### procedure

<ExpandableTable
  jsonPath="nodes.model\.input_layer\.procedure.columns"
/>
